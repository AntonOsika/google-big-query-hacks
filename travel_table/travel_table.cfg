[job]
projectid = 
localPath = 
serviceAccountEmail = 
keyFile = 
query = SELECT [ga.fullvisitorid] as fullvisitorid,[ga.sessionid] as sessionid, concat([ga.sessionid], string([ga.hitnumber])) as hitid,[ga.brandlabel] as brandlabel,[ga.calendarDate] as calendardate,[ga.travelAction] as action,[ga.travelType] as type,[ga.travelDepartureCode] as departurecode,[ga.travelDestinationCode] as destinationcode,[ga.travelHotelCode] as hotelcode,[ga.travelRoomType] as roomtype,[ga.travelDuration] as duration,[ga.travelDepartureDate] as departuredate,[ga.travelHits] as hits,[ga.travelBno] as bookingnumber,[ga.travelResortCode] as resortcode,[ga.travelAges] as ages,[ga.travelAdults] as adults,[ga.travelChildren] as children,[ga.travelSameRoom] as sameroom,[ga.travelCountryCode] as countrycode,[ga.travelDepartureYear] as departureyear,[ga.travelDepartureMonth] as departuremonth,[ga.travelDepartureMonthOfYear] as departuremonthofyear,[ga.travelCityPair] as citypair,[ga.travelPageType] as pagetype,[ga.travelAlternativeResult] as alternativeresult,[ga.extrasBookFlightMeal] as extrasbookflightmeal,[ga.travelDepartureLeadTime] as departureleadtime,[ga.travelSaleType] as saletype,[ga.travelCategoryInfoFilter] as categoryinfofilter,[ga.travelHotelInfoFilter] as hotelinfofilter,[ga.travelSortOrder] as sortorder,[ga.travelCarrier] as carrier,[ga.travelDepartureTimeWindow] as departuretimewindow,[ga.travelFlightStops] as flightstops,[ga.travelMaxFlightTime] as maxflighttime,[ga.travelPricefilter] as pricefilter,[ga.travelReturnTimeWindow] as returntimewindow,  [ga.travelPrice] as price,[ga.travelPax] as pax,booking,bookingpax as bookingpax,zerohit as zerohit,[dt.ISODate] as isodate,[dt.CalendarWeek] as calendarweek,[dt.YearWeek] as yearweek,[dt.CalendarMonth] as calendarmonth,[dt.YearMonth] as yearmonth,[dt.CalendarYear] as calendaryear, FROM (SELECT *, CASE WHEN travelAction='Booking' THEN 1 ELSE 0 END AS booking, CASE WHEN travelAction='Booking' THEN travelPAX ELSE 0 END AS bookingpax, CASE WHEN travelHits='0' THEN 1 ELSE 0 END AS zerohit FROM (SELECT [fullvisitorid] as fullvisitorid,concat(string([visitid]), [fullvisitorid]) as sessionid,[hits.hitnumber] as hitnumber,[hits.page.hostname] as brandlabel,[date] as calendarDate,max(case when [hits.customdimensions.index] = 7 then [hits.customdimensions.value] end) travelAction,max(case when [hits.customdimensions.index] = 8 then [hits.customdimensions.value] end) travelType,max(case when [hits.customdimensions.index] = 9 then [hits.customdimensions.value] end) travelDepartureCode,	max(case when [hits.customdimensions.index] = 10 then [hits.customdimensions.value] end) travelDestinationCode,max(case when [hits.customdimensions.index] = 11 then [hits.customdimensions.value] end) travelHotelCode,max(case when [hits.customdimensions.index] = 12 then [hits.customdimensions.value] end) travelRoomType,max(case when [hits.customdimensions.index] = 13 then [hits.customdimensions.value] end) travelDuration,max(case when [hits.customdimensions.index] = 14 then [hits.customdimensions.value] end) travelDepartureDate,max(case when [hits.customdimensions.index] = 15 then [hits.customdimensions.value] end) travelHits,max(case when [hits.customdimensions.index] = 16 then [hits.customdimensions.value] end) travelBno,max(case when [hits.customdimensions.index] = 17 then [hits.customdimensions.value] end) travelResortCode,max(case when [hits.customdimensions.index] = 18 then [hits.customdimensions.value] end) travelAges,max(case when [hits.customdimensions.index] = 19 then [hits.customdimensions.value] end) travelAdults,max(case when [hits.customdimensions.index] = 20 then [hits.customdimensions.value] end) travelChildren,max(case when [hits.customdimensions.index] = 21 then [hits.customdimensions.value] end) travelSameRoom,max(case when [hits.customdimensions.index] = 22 then [hits.customdimensions.value] end) travelCountryCode,max(case when [hits.customdimensions.index] = 23 then [hits.customdimensions.value] end) travelDepartureYear,max(case when [hits.customdimensions.index] = 24 then [hits.customdimensions.value] end) travelDepartureMonth,max(case when [hits.customdimensions.index] = 25 then [hits.customdimensions.value] end) travelDepartureMonthOfYear,max(case when [hits.customdimensions.index] = 26 then [hits.customdimensions.value] end) travelCityPair,max(case when [hits.customdimensions.index] = 27 then [hits.customdimensions.value] end) travelPageType,max(case when [hits.customdimensions.index] = 29 then [hits.customdimensions.value] end) travelAlternativeResult,max(case when [hits.customdimensions.index] = 30 then [hits.customdimensions.value] end) extrasBookFlightMeal,max(case when [hits.customdimensions.index] = 32 then [hits.customdimensions.value] end) travelDepartureLeadTime,max(case when [hits.customdimensions.index] = 33 then [hits.customdimensions.value] end) travelSaleType,max(case when [hits.customdimensions.index] = 35 then [hits.customdimensions.value] end) travelCategoryInfoFilter,max(case when [hits.customdimensions.index] = 36 then [hits.customdimensions.value] end) travelHotelInfoFilter,max(case when [hits.customdimensions.index] = 37 then [hits.customdimensions.value] end) travelSortOrder,max(case when [hits.customdimensions.index] = 38 then [hits.customdimensions.value] end) travelCarrier,max(case when [hits.customdimensions.index] = 39 then [hits.customdimensions.value] end) travelDepartureTimeWindow,max(case when [hits.customdimensions.index] = 40 then [hits.customdimensions.value] end) travelFlightStops,max(case when [hits.customdimensions.index] = 41 then [hits.customdimensions.value] end) travelMaxFlightTime,max(case when [hits.customdimensions.index] = 42 then [hits.customdimensions.value] end) travelPriceFilter,max(case when [hits.customdimensions.index] = 43 then [hits.customdimensions.value] end) travelReturnTimeWindow,max(case when [hits.custommetrics.index] = 1 then [hits.custommetrics.value] end) travelPrice,max(case when [hits.custommetrics.index] = 2 then [hits.custommetrics.value] end) travelPax,FROM [76948779.ga_sessions_%1],[76950139.ga_sessions_%1], [76950634.ga_sessions_%1],[76953109.ga_sessions_%1],[76949285.ga_sessions_%1] WHERE ([hits.type] = 'EVENT') AND ([hits.eventinfo.eventcategory] = 'Travel') GROUP EACH BY sessionid, hitnumber , [calendarDate], [fullvisitorid], [brandlabel]) AS ga JOIN [1_web_data.dim_DateTime] as dt on ga.calendarDate = dt.GregorianDate);
#daysAgo, set with one or multiple values separated by space
daysAgo = 1
allowLargeResults = True
createdisposition = CREATE_IF_NEEDED
writedisposition = WRITE_APPEND
datasetid = sahlin
tableid = testTravel
destinationBucket = 
destinationObject = 
destinationFormat = 
